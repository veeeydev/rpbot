const interpreter = require("../interpreter.js")

module.exports = async (client, omsg, nmsg, db) => {
  
  if (!nmsg.author) await nmsg.fetch()
  
  if (nmsg.author && nmsg.author.bot) return
  
  for (const command of client.update_commands.array()) {
    
    const id = await interpreter(client, nmsg, [], {
      channel: command.channel,
      code: command.channel
    }, db, true)

    const channel = nmsg.guild.channels.cache.get(id)

    if (!channel) return console.error(`channel with ID ${id} does not exist`)

    const channelUsed = nmsg.channel.id

    nmsg.channel = channel

    await interpreter(client, nmsg, nmsg.content.split(" "), command, db, false, channelUsed, {
        oldMessage: omsg ? omsg.content.deleteBrackets() : "" 
    }) 
  } 
    
} 