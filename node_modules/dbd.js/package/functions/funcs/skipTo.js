const embed = require("../../handlers/errors.js")
module.exports = async d => {
    const code = d.command.code
    const server = d.client.servers.get(d.message.guild.id)

    if(!server) return d.error(`:x: Nothing is being played!`)
    var songs = server.songs
    
        const r = code.split("$skipTo").length - 1
    
        const after = code.split("$skipTo")[r]
    
        if (after.startsWith("[")) {
            const inside = after.split("[")[1].split("]")[0]
            if(isNaN(inside)) return embed(d, ":x: Argument is not a number in $skipTo["+inside+"]")
if(inside < 2) { server.connection.dispatcher.end()
return {
code: d.command.code.replaceLast(`$skipTo[${inside}]`, "")
}
}
const spliced = server.songs.splice(0, Math.floor(inside - 1))

server.connection.dispatcher.end()

if (server.loopQueue == true) server.songs.push(...spliced)
            
            d.client.servers.set(d.message.guild.id, server)
    
            return {code: d.command.code.replaceLast(`$skipTo[${inside}]`, "")}
        } else {
            return embed(d, ":x: Command name $skipTo is invalid")
        }
    
}
