const username = async d => {
  
  let code = d.command.code
  
  const r = code.split("$username").length - 1
  
  const after = code.split("$username")[r]
  
  if (after.startsWith("[")) {
    const inside = after.split("[")[1].split("]")[0]
    
    const user = await d.client.users.fetch(inside).catch(err => {})
    
    if (!user) return d.error(`❌ Invalid user ID in \`$username[${inside}]\``)
    
    code = code.replaceLast(`$username[${inside}]`, user.username.deleteBrackets())
  } else {
    code = code.replaceLast("$username", d.message.author.username.deleteBrackets())
  }
  
  return {
    code: code 
  } 
} 

module.exports = username 