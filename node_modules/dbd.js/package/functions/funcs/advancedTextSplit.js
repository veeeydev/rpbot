module.exports = async d => {
    const code = d.command.code 
    
    const r = code.split("$advancedTextSplit[").length - 1 
    
    const inside = code.split("$advancedTextSplit[")[r].split("]")[0] 
    
    const fields = inside.split(";") 
    
    let text, started = false 
    
    while (fields.length) {
        if (started) {
            let [split, index] = fields.splice(0, 2)
            
            index = Number(index) - 1 || 0
            
            text = text.split(split)[index] || "" 
        } else {
            let [m, split, index] = fields.splice(0, 3)
            
            index = Number(index) - 1 || 0
            
            text = m.split(split)[index] || ""
            
            started = true 
        }
    } 
        
    return {
        code: d.command.code.replaceLast(`$advancedTextSplit[${inside}]`, text)
    }
}