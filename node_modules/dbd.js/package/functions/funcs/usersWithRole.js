module.exports = async d => {
    const code = d.command.code

    const r = code.split("$usersWithRole[").length - 1

    const inside =code.split("$usersWithRole[")[r].split("]")[0]

    const options = [
        roleID,
        separator = "\n",
        forceCache = "no"
    ] = inside.split(";")

    if (forceCache === "yes") {
        if (d.message.guild.memberCount !== d.message.guild.members.cache.size) {
            await d.message.guild.members.fetch()
        }
    }

    const role = d.message.guild.roles.cache.get(roleID)

    if (!role) return d.error(`:x: Invalid role ID in \`$usersWithRole[${inside}]\``)

    return {
        code: code.replaceLast(`$usersWithRole[${inside}]`, role.members.map(m => m.user.tag).join(separator).removeBrackets())
    }
}