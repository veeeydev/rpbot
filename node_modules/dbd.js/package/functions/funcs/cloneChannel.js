module.exports = async d => {
    const code = d.command.code

    const r = code.split("$cloneChannel").length - 1

    const after =code.split("$cloneChannel")

    if (after[0] === "[") {
        const inside = after.slice(1).split("]")[0]

        let channel = d.message.guild.channels.cache.get(inside)

        if (!channel) return d.error(`:x: Invalid channel ID in \`$cloneChannel[${inside}]\``)

        const data = {
            name: channel.name,
            position: channel.position
        }

        channel = await d.message.channel.clone().catch(Err => {})

        if (!channel) return d.error(`:x: Failed to clone channel`)

        await channel.setName(data.name)
        await channel.setPosition(data.position)
        
        return {
            code: code.replaceLast(`$cloneChannel[${inside}]`, "")
        }
    } else {

        const data = {
            name: d.message.channel.name,
            position: d.message.channel.position
        }

        const channel = await d.message.channel.clone().catch(Err => {})

        if (!channel) return d.error(`:x: Failed to clone channel`)

        await channel.setName(data.name)
        await channel.setPosition(data.position)

        return {
            code: code.replaceLast(`$cloneChannel`, "")
        }
    }
}