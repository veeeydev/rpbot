const userAvatar = async d => {
  
  let code = d.command.code
  
  const r = code.split("$userAvatar").length - 1
  
  const after = code.split("$userAvatar")[r]
  
  if (after.startsWith("[")) {
    
    const inside = after.split("[")[1].split("]")[0]
    
    const [ id, size = "2048", dynamic = "yes" ] = inside.split(";")
    
    const user = await d.client.users.fetch(id).catch(err => {})
    
    if (!user) return d.error(`‚ùå Invalid user ID in \`$userAvatar[${inside}]\``)
    
    code = code.replaceLast(`$userAvatar[${inside}]`, user.displayAvatarURL({
      dynamic: dynamic === "yes" ? true : false,
      size: Number(size) 
    }))
    
  } else {
    code = code.replaceLast("$userAvatar", d.message.author.displayAvatarURL({dynamic:true, size: 4096})) 
  }
  
  return {
    code: code 
  } 
}

module.exports = userAvatar