const ms = require("parse-ms")
const parse = require("ms-parser")

module.exports = async d => {
    const code = d.command.code

    const r = code.split("$parseDate[").length - 1

    const inside = code.split("$parseDate[")[r].split("]")[0]

    const[
        time,
        date = "date"
    ] = inside.split(";")

    return {
        code: code.replaceLast(`$parseDate[${inside}]`, date === "date" ? new Date(Number(time)) : parse(Object.entries(ms(Number(time))).map((x, y) => {
            if (x[1] && y < 4) return `${x[1]}${x[0][0]}`
            else return undefined
        }).filter(e => e).join("")).string)
    }
}