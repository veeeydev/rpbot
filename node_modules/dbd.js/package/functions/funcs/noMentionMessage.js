module.exports = d => {
  
  let code = d.command.code
  
  const r = code.split("$noMentionMessage").length - 1
  
  const after = code.split("$noMentionMessage")[r]
  
  d.args = d.args.filter(arg => !["<@&", "<@", "<#"].some(e => arg.startsWith(e)) && !arg.endsWith(">"))
  
  if (after.startsWith("[")) {
    const n = after.split("[")[1].split("]")[0]
    
    if (isNaN(n)) return d.error(`❌ Invalid number in \`$noMentionMessage[${n}]\``)
    
    code = code.replaceLast(`$noMentionMessage[${n}]`, d.args[Number(n) - 1] ? d.args[Number(n) - 1].deleteBrackets() : "")
  } else {
    code = code.replaceLast("$noMentionMessage", d.args.join(" ").deleteBrackets()) 
  }
  
  return {
    code: code 
  } 
}