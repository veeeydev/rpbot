module.exports = async d => {
    const code =d.command.code
    
    const r = code.split("$getLeaderboardInfo[").length - 1
    
    const inside = code.split("$getLeaderboardInfo[")[r].split("]")[0] 
    
    const [variable, id, type = "user", option = "top"] = inside.split(";") 
    
    const res = type === "user" ? `${d.message.guild.id}_` : type === "globaluser" ? "" : id
    
    const docs = (await d.client.db.find({
            variable: variable 
    })).filter(e => e.varID.startsWith(res)).sort((x, y) => Number(y.value) - Number(x.value))
    
    const ID = res.includes("_") ? res + id : id 
    
    const data = type === "server" ? d.client.guilds.cache.get(id) || {} : await d.client.users.fetch(id)
    
    //console.log(docs, res) 
    
    const options = {
        top: docs.findIndex(e => e.varID === ID)  + 1,
        name: type === "server" ? data.name : data.tag, 
        value: docs.find(e => e.varID === ID) ? docs.find(e => e.varID === ID). value: 0
    }[option] 
    
    return{
        code: code.replaceLast(`$getLeaderboardInfo[${inside}]`, options)
    }
}